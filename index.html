<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SGD-A | Sistema de Gestão de Demandas e Alocação (MVP)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- date-fns (para manipulação de datas) -->
    <script src="https://cdn.jsdelivr.net/npm/date-fns@3.6.0/cdn.min.js"></script>
    <script>
      // Mapeia globalmente para facilitar o uso no módulo
      window.dateFns = dateFns;
    </script>
    <!-- FullCalendar (para a Agenda) -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  </head>
  <body class="antialiased text-gray-800">
    <!-- Cabeçalho Principal -->
    <header class="bg-white shadow-md">
      <nav
        class="container mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center h-16"
      >
        <div class="flex items-center space-x-4">
          <svg
            class="h-8 w-8 text-blue-600"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008Zm0 2.25h.008v.008H9.75v-.008Zm0-4.5h.008v.008H9.75v-.008Zm1.5-2.25h.008v.008H11.25v-.008Zm1.5 0h.008v.008H12.75v-.008Zm1.5 0h.008v.008H14.25v-.008ZM9.75 9.75h.008v.008H9.75v-.008Zm1.5 0h.008v.008H11.25v-.008Zm1.5 0h.008v.008H12.75v-.008Zm1.5 0h.008v.008H14.25v-.008Z"
            />
          </svg>
          <h1 class="text-xl font-bold text-gray-800">SGD-A (MVP)</h1>
        </div>
        <div class="flex items-center space-x-2">
          <button
            id="nav-painel"
            class="nav-link px-3 py-2 rounded-md text-sm font-medium text-white bg-blue-600"
            aria-current="page"
          >
            Painel
          </button>
          <button
            id="nav-agenda"
            class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700"
          >
            Agenda
          </button>
          <button
            id="nav-cadastros"
            class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700"
          >
            Cadastros
          </button>
        </div>
        <!-- Simulador de Perfil de Usuário -->
        <div id="simulador-perfil" class="flex items-center space-x-2">
          <label
            for="simular-usuario-select"
            class="text-sm font-medium text-gray-600"
            >Visão:</label
          >
          <select
            id="simular-usuario-select"
            class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm py-1"
          >
            <option value="Coordenador">Coordenador</option>
            <option value="Solicitante">Solicitante</option>
          </select>
        </div>
      </nav>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
      <!-- TELA 1: Painel de Demandas -->
      <div id="tela-painel" class="tela ativa">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-semibold text-gray-900">
            Painel de Gestão de Demandas
          </h2>
          <button
            id="btn-nova-demanda"
            class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow flex items-center"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="w-5 h-5 mr-2"
            >
              <path
                d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"
              />
            </svg>
            Nova Demanda
          </button>
        </div>

        <!-- Abas de Status -->
        <div class="mb-4 border-b border-gray-200">
          <nav class="-mb-px flex space-x-6" aria-label="Tabs">
            <button
              data-status="Aguardando Aprovação"
              class="tab-link-aprovacao tab-link whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
            >
              Aguardando Aprovação
              <span
                id="count-aguardando"
                class="ml-1.5 rounded-full bg-yellow-100 text-yellow-700 px-2 py-0.5 text-xs font-medium"
                >0</span
              >
            </button>
            <button
              data-status="Solicitada"
              class="tab-link whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-blue-500 text-blue-600"
            >
              Solicitadas
              <span
                id="count-solicitada"
                class="ml-1.5 rounded-full bg-blue-100 text-blue-600 px-2 py-0.5 text-xs font-medium"
                >0</span
              >
            </button>
            <button
              data-status="Programada"
              class="tab-link whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
            >
              Programadas
              <span
                id="count-programada"
                class="ml-1.5 rounded-full bg-gray-100 text-gray-600 px-2 py-0.5 text-xs font-medium"
                >0</span
              >
            </button>
            <button
              data-status="Em Andamento"
              class="tab-link whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
            >
              Em Andamento
              <span
                id="count-emandamento"
                class="ml-1.5 rounded-full bg-gray-100 text-gray-600 px-2 py-0.5 text-xs font-medium"
                >0</span
              >
            </button>
            <button
              data-status="Concluída"
              class="tab-link whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
            >
              Concluídas
            </button>
            <button
              data-status="Cancelada"
              class="tab-link whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
            >
              Canceladas
            </button>
          </nav>
        </div>

        <!-- Tabela de Demandas -->
        <div class="bg-white shadow-lg rounded-lg overflow-hidden">
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Curso
                  </th>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Município
                  </th>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Período
                  </th>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Horário
                  </th>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Solicitante
                  </th>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Docente
                  </th>
                  <th
                    scope="col"
                    class="px-5 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                  >
                    Ação
                  </th>
                </tr>
              </thead>
              <tbody
                id="tabela-demandas-corpo"
                class="bg-white divide-y divide-gray-200"
              >
                <!-- Linhas de demanda serão inseridas aqui pelo JS -->
              </tbody>
            </table>
          </div>
        </div>
        <div id="loading-demandas" class="text-center p-10 text-gray-500">
          Carregando demandas...
        </div>
      </div>

      <!-- TELA 2: Agenda (FullCalendar) -->
      <div id="tela-agenda" class="tela">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-semibold text-gray-900">
            Agenda de Alocações
          </h2>
          <div class="flex space-x-4">
            <select
              id="filtro-agenda-tipo"
              class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            >
              <option value="docentes">Visão por Docentes</option>
              <option value="recursos">Visão por Recursos</option>
            </select>
            <select
              id="filtro-agenda-selecao"
              class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            >
              <!-- Opções carregadas pelo JS -->
            </select>
          </div>
        </div>
        <div id="loading-agenda" class="text-center p-10 text-gray-500">
          Carregando agenda...
        </div>
        <div id="calendar-container" class="bg-white p-4 rounded-lg shadow-lg">
          <div id="calendar"></div>
        </div>
      </div>

      <!-- TELA 3: Cadastros -->
      <div id="tela-cadastros" class="tela">
        <h2 class="text-2xl font-semibold text-gray-900 mb-6">Cadastros</h2>
        <p class="text-gray-600 mb-4">
          Gerencie os dados mestres do sistema. (Funcionalidade de cadastro
          completo será expandida pós-MVP).
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Card Docentes -->
          <div class="bg-white shadow-lg rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-3">Docentes</h3>
            <form id="form-add-docente">
              <input
                type="text"
                id="docente-nome"
                placeholder="Nome do Docente"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              />
              <select
                id="docente-area"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              >
                <option value="">Selecione a Área Principal</option>
                <option value="Alimentos">Alimentos</option>
                <option value="Metalurgia">Metalurgia</option>
                <option value="Construção Civil">Construção Civil</option>
                <option value="Gestão">Gestão</option>
              </select>
              <input
                type="text"
                id="docente-subareas"
                placeholder="Subáreas (separadas por vírgula)"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              />
              <select
                id="docente-contrato"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              >
                <option value="">Tipo de Contrato</option>
                <option value="Mensalista">Mensalista (40h/sem)</option>
                <option value="Horista">Horista (200h/mês)</option>
              </select>
              <button
                type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg"
              >
                Adicionar Docente
              </button>
            </form>
            <ul
              id="lista-docentes"
              class="mt-4 space-y-2 max-h-40 overflow-y-auto"
            ></ul>
          </div>

          <!-- Card Cursos -->
          <div class="bg-white shadow-lg rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-3">Cursos</h3>
            <form id="form-add-curso">
              <input
                type="text"
                id="curso-titulo"
                placeholder="Título do Curso"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              />
              <select
                id="curso-area"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              >
                <option value="">Selecione a Área</option>
                <option value="Alimentos">Alimentos</option>
                <option value="Metalurgia">Metalurgia</option>
                <option value="Construção Civil">Construção Civil</option>
                <option value="Gestão">Gestão</option>
              </select>
              <input
                type="number"
                id="curso-ch-tecnica"
                placeholder="CH Técnica (ex: 80)"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              />
              <input
                type="number"
                id="curso-ch-gestao"
                placeholder="CH Gestão (ex: 8)"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              />
              <select
                id="curso-recursos"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
              >
                <option value="">Recurso Crítico (Opcional)</option>
                <!-- Recursos carregados do DB -->
              </select>
              <button
                type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg"
              >
                Adicionar Curso
              </button>
            </form>
            <ul
              id="lista-cursos"
              class="mt-4 space-y-2 max-h-40 overflow-y-auto"
            ></ul>
          </div>

          <!-- Card Recursos -->
          <div class="bg-white shadow-lg rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-3">
              Recursos (Escolas Móveis)
            </h3>
            <form id="form-add-recurso">
              <input
                type="text"
                id="recurso-nome"
                placeholder="Nome do Recurso (ex: EM 1075)"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              />
              <select
                id="recurso-tipo"
                class="w-full border-gray-300 rounded-md shadow-sm mb-2"
                required
              >
                <option value="Móvel">Escola Móvel</option>
                <option value="Kit">Kit</option>
                <option value="Sala">Sala Especial</option>
              </select>
              <button
                type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg"
              >
                Adicionar Recurso
              </button>
            </form>
            <ul
              id="lista-recursos"
              class="mt-4 space-y-2 max-h-40 overflow-y-auto"
            ></ul>
          </div>
        </div>

        <button
          id="btn-seed-db"
          class="mt-6 bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg shadow"
        >
          Carregar Dados da Planilha (Demo)
        </button>
        <p id="seed-status" class="mt-2 text-sm text-gray-600"></p>
      </div>
    </main>

    <!-- MODAL: Nova Demanda -->
    <div
      id="modal-nova-demanda"
      class="fixed inset-0 z-50 overflow-y-auto hidden"
    >
      <div
        id="modal-backdrop"
        class="fixed inset-0 transition-opacity"
        aria-hidden="true"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div
          class="relative bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 sm:p-8 transform transition-all"
        >
          <button
            id="btn-fechar-modal-demanda"
            class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18 18 6M6 6l12 12"
              />
            </svg>
          </button>
          <h3 class="text-xl font-semibold text-gray-900 mb-6">
            Registrar Nova Demanda
          </h3>
          <form id="form-nova-demanda" class="space-y-4">
            <!-- Tipo de Registro -->
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Tipo de Registro</label
              >
              <fieldset class="mt-2">
                <legend class="sr-only">Tipo de Registro</legend>
                <div class="flex items-center space-x-6">
                  <div class="flex items-center">
                    <input
                      id="tipoDemandaCoordenacao"
                      name="tipoDemanda"
                      type="radio"
                      value="Coordenador"
                      checked
                      class="h-4 w-4 text-blue-600 border-gray-300"
                    />
                    <label
                      for="tipoDemandaCoordenacao"
                      class="ml-2 block text-sm text-gray-900"
                      >Demanda da Coordenação</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      id="tipoDemandaSolicitante"
                      name="tipoDemanda"
                      type="radio"
                      value="Solicitante"
                      class="h-4 w-4 text-blue-600 border-gray-300"
                    />
                    <label
                      for="tipoDemandaSolicitante"
                      class="ml-2 block text-sm text-gray-900"
                      >Demanda do Solicitante</label
                    >
                  </div>
                </div>
              </fieldset>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label
                  for="demanda-solicitante"
                  class="block text-sm font-medium text-gray-700"
                  >Solicitante</label
                >
                <input
                  type="text"
                  id="demanda-solicitante"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                  required
                />
              </div>
              <div>
                <label
                  for="demanda-municipio"
                  class="block text-sm font-medium text-gray-700"
                  >Município</label
                >
                <input
                  type="text"
                  id="demanda-municipio"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                  required
                />
              </div>
            </div>
            <div>
              <label
                for="demanda-area"
                class="block text-sm font-medium text-gray-700"
                >Área de Atuação</label
              >
              <select
                id="demanda-area"
                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                required
              >
                <option value="">Selecione a Área</option>
                <!-- Populado por JS -->
              </select>
            </div>
            <div>
              <label
                for="demanda-curso"
                class="block text-sm font-medium text-gray-700"
                >Curso</label
              >
              <select
                id="demanda-curso"
                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                required
                disabled
              >
                <option value="">Selecione primeiro a Área</option>
              </select>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label
                  for="demanda-data-inicio"
                  class="block text-sm font-medium text-gray-700"
                  >Data Início</label
                >
                <input
                  type="date"
                  id="demanda-data-inicio"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                  required
                />
              </div>
              <div>
                <label
                  for="demanda-data-fim"
                  class="block text-sm font-medium text-gray-700"
                  >Data Fim</label
                >
                <input
                  type="date"
                  id="demanda-data-fim"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                  required
                />
              </div>
            </div>
            <!-- Campos de Gestão (visíveis apenas para Coordenador) -->
            <div
              id="campos-gestao"
              class="grid grid-cols-1 sm:grid-cols-2 gap-4"
            >
              <div>
                <label
                  for="demanda-data-gestao1"
                  class="block text-sm font-medium text-gray-700"
                  >Data Gestão 1 (Opcional)</label
                >
                <input
                  type="date"
                  id="demanda-data-gestao1"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                />
              </div>
              <div>
                <label
                  for="demanda-data-gestao2"
                  class="block text-sm font-medium text-gray-700"
                  >Data Gestão 2 (Opcional)</label
                >
                <input
                  type="date"
                  id="demanda-data-gestao2"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                />
              </div>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <label
                  for="demanda-horario-inicio"
                  class="block text-sm font-medium text-gray-700"
                  >Horário Início</label
                >
                <input
                  type="time"
                  id="demanda-horario-inicio"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                  required
                />
              </div>
              <div>
                <label
                  for="demanda-horario-fim"
                  class="block text-sm font-medium text-gray-700"
                  >Horário Fim</label
                >
                <input
                  type="time"
                  id="demanda-horario-fim"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm"
                  required
                />
              </div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Dias da Semana</label
              >
              <div class="flex flex-wrap gap-2">
                <!-- Checkboxes para dias da semana -->
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="1"
                    class="rounded text-blue-600"
                    checked
                  />
                  <span>Seg</span>
                </label>
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="2"
                    class="rounded text-blue-600"
                    checked
                  />
                  <span>Ter</span>
                </label>
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="3"
                    class="rounded text-blue-600"
                    checked
                  />
                  <span>Qua</span>
                </label>
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="4"
                    class="rounded text-blue-600"
                    checked
                  />
                  <span>Qui</span>
                </label>
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="5"
                    class="rounded text-blue-600"
                    checked
                  />
                  <span>Sex</span>
                </label>
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="6"
                    class="rounded text-blue-600"
                  />
                  <span>Sáb</span>
                </label>
                <label
                  class="flex items-center space-x-2 p-2 rounded-md border border-gray-300"
                >
                  <input
                    type="checkbox"
                    name="diasSemana"
                    value="0"
                    class="rounded text-blue-600"
                  />
                  <span>Dom</span>
                </label>
              </div>
            </div>

            <div class="pt-5">
              <button
                type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow"
              >
                Salvar Demanda
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- MODAL: Tela de Alocação -->
    <div id="modal-alocacao" class="fixed inset-0 z-50 overflow-y-auto hidden">
      <div
        id="modal-backdrop-alocacao"
        class="fixed inset-0 transition-opacity"
        aria-hidden="true"
        style="background-color: rgba(0, 0, 0, 0.5)"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div
          class="relative bg-white rounded-lg shadow-xl w-full max-w-4xl p-6 sm:p-8 transform transition-all"
        >
          <button
            id="btn-fechar-modal-alocacao"
            class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18 18 6M6 6l12 12"
              />
            </svg>
          </button>
          <h3
            id="alocacao-titulo"
            class="text-xl font-semibold text-gray-900 mb-6"
          >
            Alocar Demanda: ...
          </h3>

          <!-- Secção 1: Resumo -->
          <div class="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
            <h4 class="text-lg font-medium text-gray-800 mb-3">
              Resumo da Demanda
            </h4>
            <div
              id="alocacao-resumo"
              class="grid grid-cols-2 sm:grid-cols-3 gap-4 text-sm"
            >
              <!-- Conteúdo preenchido por JS -->
            </div>
          </div>

          <!-- Secção 2: Verificação de Recursos -->
          <div class="p-4 rounded-lg mb-6 border border-gray-200">
            <h4 class="text-lg font-medium text-gray-800 mb-3">
              Verificação de Recursos
            </h4>
            <div id="alocacao-recursos">
              <!-- Conteúdo preenchido por JS -->
            </div>
          </div>

          <!-- Secção 3: Sugestões de Docentes -->
          <div>
            <h4 class="text-lg font-medium text-gray-800 mb-3">
              Sugestões de Docentes
            </h4>
            <div
              id="alocacao-loading-docentes"
              class="text-center p-8 text-gray-500"
            >
              <svg
                class="animate-spin h-6 w-6 text-blue-600 mx-auto"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
              >
                <circle
                  class="opacity-25"
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="4"
                ></circle>
                <path
                  class="opacity-75"
                  fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
              Analisando competências, agendas e contratos...
            </div>
            <div id="alocacao-sugestoes" class="space-y-4">
              <!-- Cards de sugestão preenchidos por JS -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MODAL: Detalhes da Demanda Programada -->
    <div
      id="modal-detalhes-programada"
      class="fixed inset-0 z-50 overflow-y-auto hidden"
    >
      <div
        id="modal-backdrop-detalhes"
        class="fixed inset-0 transition-opacity"
        aria-hidden="true"
        style="background-color: rgba(0, 0, 0, 0.5)"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div
          class="relative bg-white rounded-lg shadow-xl w-full max-w-3xl p-6 sm:p-8 transform transition-all"
        >
          <button
            id="btn-fechar-modal-detalhes"
            class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M6 18 18 6M6 6l12 12"
              />
            </svg>
          </button>
          <h3
            id="detalhes-titulo"
            class="text-xl font-semibold text-gray-900 mb-6"
          >
            Detalhes do Curso
          </h3>

          <!-- Conteúdo do Modal -->
          <form id="form-detalhes-curso">
            <!-- Seção de Informações Estáticas -->
            <div class="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
              <h4 class="text-md font-medium text-gray-800 mb-3">
                Informações Gerais
              </h4>
              <div
                id="modal-detalhes-info-estatica"
                class="grid grid-cols-2 sm:grid-cols-3 gap-x-6 gap-y-4 text-sm"
              >
                <!-- Infos não-editáveis (Docente, Período, etc.) vão aqui -->
                <p class="text-gray-500 text-center col-span-full">
                  Carregando...
                </p>
              </div>
            </div>

            <!-- Seção de Informações Editáveis (Resultados) -->
            <div class="mb-6">
              <h4 class="text-md font-medium text-gray-800 mb-3">
                Resultados e Acompanhamento (Opcional)
              </h4>
              <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                <!-- Coluna 1 -->
                <div>
                  <label
                    for="detalhes-proposta-sgset"
                    class="block text-sm font-medium text-gray-700"
                    >Proposta Nº SGSET</label
                  >
                  <input
                    type="text"
                    id="detalhes-proposta-sgset"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div>
                  <label
                    for="detalhes-demanda-num"
                    class="block text-sm font-medium text-gray-700"
                    >Demanda</label
                  >
                  <input
                    type="text"
                    id="detalhes-demanda-num"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div>
                  <label
                    for="detalhes-rae"
                    class="block text-sm font-medium text-gray-700"
                    >R.A.E</label
                  >
                  <input
                    type="text"
                    id="detalhes-rae"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div>
                  <label
                    for="detalhes-video"
                    class="block text-sm font-medium text-gray-700"
                    >Video</label
                  >
                  <input
                    type="text"
                    id="detalhes-video"
                    placeholder="http://..."
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div>
                  <label
                    for="detalhes-matr-previstas"
                    class="block text-sm font-medium text-gray-700"
                    >Matr. Previstas</label
                  >
                  <input
                    type="number"
                    id="detalhes-matr-previstas"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div>
                  <label
                    for="detalhes-matr-realizadas"
                    class="block text-sm font-medium text-gray-700"
                    >Matr. Realizadas</label
                  >
                  <input
                    type="number"
                    id="detalhes-matr-realizadas"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div>
                  <label
                    for="detalhes-evasao"
                    class="block text-sm font-medium text-gray-700"
                    >Evasão</label
                  >
                  <input
                    type="number"
                    id="detalhes-evasao"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
                <div class="sm:col-span-2">
                  <label
                    for="detalhes-receita"
                    class="block text-sm font-medium text-gray-700"
                    >Receita Final</label
                  >
                  <input
                    type="number"
                    id="detalhes-receita"
                    placeholder="0.00"
                    class="mt-1 block w-full border-gray-300 rounded-md shadow-sm text-sm"
                  />
                </div>
              </div>
            </div>
          </form>

          <!-- Botões de Ação -->
          <div class="flex flex-col sm:flex-row justify-end sm:space-x-3">
            <!-- Botão de Cancelar -->
            <button
              id="btn-cancelar-demanda-modal"
              type="button"
              class="mt-2 sm:mt-0 bg-red-100 hover:bg-red-200 text-red-700 border border-red-200 font-bold py-2 px-4 rounded-lg w-full sm:w-auto order-first sm:mr-auto hidden"
            >
              Cancelar Demanda
            </button>

            <button
              id="btn-fechar-modal-detalhes-footer"
              type="button"
              class="mt-2 sm:mt-0 bg-white hover:bg-gray-100 text-gray-700 font-medium py-2 px-4 rounded-lg border border-gray-300 w-full sm:w-auto"
            >
              Fechar
            </button>
            <button
              id="btn-salvar-detalhes"
              type="button"
              class="mt-2 sm:mt-0 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow w-full sm:w-auto hidden"
            >
              Salvar Alterações
            </button>
            <button
              id="btn-iniciar-curso"
              type="button"
              class="mt-2 sm:mt-0 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg shadow flex items-center justify-center w-full sm:w-auto hidden"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="w-5 h-5 mr-2"
              >
                <path
                  fill-rule="evenodd"
                  d="M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z"
                  clip-rule="evenodd"
                />
              </svg>
              Salvar e Iniciar Curso
            </button>
            <!-- Botão de Concluir -->
            <button
              id="btn-concluir-curso"
              type="button"
              class="mt-2 sm:mt-0 bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg shadow flex items-center justify-center w-full sm:w-auto hidden"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="w-5 h-5 mr-2"
              >
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z"
                  clip-rule="evenodd"
                />
              </svg>
              Salvar e Concluir Curso
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- MODAL: Confirmação de Cancelamento -->
    <div
      id="modal-confirmar-cancelamento"
      class="fixed inset-0 z-[100] overflow-y-auto hidden"
    >
      <!-- Overlay -->
      <div
        class="fixed inset-0 transition-opacity"
        aria-hidden="true"
        style="background-color: rgba(0, 0, 0, 0.6)"
      ></div>

      <!-- Conteúdo do Modal -->
      <div class="flex items-center justify-center min-h-screen p-4">
        <div
          class="relative bg-white rounded-lg shadow-xl w-full max-w-md p-6 transform transition-all"
        >
          <h3 class="text-lg font-semibold text-gray-900 mb-4">
            Confirmar Cancelamento
          </h3>
          <p class="text-sm text-gray-600 mb-6">
            Tem certeza que deseja cancelar esta demanda? Esta ação não pode ser
            desfeita e liberará o docente e os recursos alocados.
          </p>
          <div class="flex justify-end space-x-3">
            <button
              id="btn-nao-cancelar"
              class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg"
            >
              Voltar
            </button>
            <button
              id="btn-sim-cancelar"
              class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg"
            >
              Sim, Cancelar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ### NOVO MODAL: Confirmação de Conclusão ### -->
    <div
      id="modal-confirmar-conclusao"
      class="fixed inset-0 z-[100] overflow-y-auto hidden"
    >
      <div
        class="fixed inset-0 transition-opacity"
        aria-hidden="true"
        style="background-color: rgba(0, 0, 0, 0.6)"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div
          class="relative bg-white rounded-lg shadow-xl w-full max-w-md p-6 transform transition-all"
        >
          <h3 class="text-lg font-semibold text-gray-900 mb-4">
            Confirmar Conclusão
          </h3>
          <p class="text-sm text-gray-600 mb-6">
            Tem certeza que deseja marcar esta demanda como "Concluída"? Os
            dados de resultado (matrículas, etc.) foram salvos.
          </p>
          <div class="flex justify-end space-x-3">
            <button
              id="btn-nao-concluir"
              class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg"
            >
              Voltar
            </button>
            <button
              id="btn-sim-concluir"
              class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg"
            >
              Sim, Concluir
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ### NOVO MODAL: Alerta Genérico ### -->
    <div id="modal-alerta" class="fixed inset-0 z-[100] overflow-y-auto hidden">
      <div
        class="fixed inset-0 transition-opacity"
        aria-hidden="true"
        style="background-color: rgba(0, 0, 0, 0.6)"
      ></div>
      <div class="flex items-center justify-center min-h-screen p-4">
        <div
          class="relative bg-white rounded-lg shadow-xl w-full max-w-md p-6 transform transition-all"
        >
          <h3
            id="modal-alerta-titulo"
            class="text-lg font-semibold text-gray-900 mb-4"
          >
            Atenção
          </h3>
          <p
            id="modal-alerta-texto"
            class="text-sm text-gray-600 mb-6 whitespace-pre-line"
          >
            Mensagem de alerta.
          </p>
          <div class="flex justify-end">
            <button
              id="btn-fechar-alerta"
              class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg"
            >
              Entendido
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast de Notificação -->
    <div
      id="toast-notificacao"
      class="fixed bottom-5 right-5 bg-green-600 text-white py-3 px-5 rounded-lg shadow-lg hidden z-50 transform translate-y-20 transition-transform duration-300 ease-out"
    >
      <span id="toast-mensagem"></span>
    </div>

    <script type="module" src="script.js"></script>
  </body>
</html>
